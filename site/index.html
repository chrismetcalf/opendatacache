<!DOCTYPE html>
<html>
  <head>
    <title>OpenDataCache</title>

    <link type="text/css" rel="stylesheet" href="/static/css/lib/common.css" />
    <link type="text/css" rel="stylesheet" href="/static/css/opendatacache.css" />

    <script src="/static/js/lib/common.js"></script>
    <script src="/static/js/opendatacache.js"></script>

  </head>
  <body>
    <header class="navbar navbar-static-top bg-info" role="banner">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a href="/" class="navbar-brand">OpenDataCache</a>
        </div>
        <nav class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li>
              <a href="#about" data-toggle="modal" data-target="#aboutModal">About</a>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="https://github.com/talos/opendatacache" target="_blank">On GitHub</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <div class="container">
      <div id="content">
      </div>
    </div>

    <table id="indexTemplate" class="template">
      <thead>
        <tr>
          <th data-field="name" data-sortable="true">Name</th>
          <th data-field="date" data-sortable="true">Date</th>
          <th data-field="status" data-sortable="true">Status</th>
          <th data-field="detail">Detail</th>
        </tr>
      </thead>
    </table>

    <table id="portalTemplate" class="template" data-search="true" data-row-style="rowStyle">
      <thead>
        <tr>
          <th data-field="name" data-sortable="true" data-formatter="nameFormatter">Name <span class="superscript">(ID)</span></th>
          <!--<th data-field="date" data-sortable="true" data-formatter="utcTimeSinceFormatter">Last Cache Check</th>-->
          <th data-field="size" data-sortable="true" data-formatter="sizeFormatter" >Size</th>
          <th data-field="status" data-sortable="true" data-formatter="statusFormatter">Status</th>
          <!--<th data-field="cacheTest" data-formatter="cacheTestFormatter">Test if cached</th>-->
          <th data-field="attribution" data-sortable="true" data-visible="false">Attribution</th>
          <th data-field="averageRating" data-sortable="true" data-visible="false">Average Rating</th>
          <th data-field="category" data-sortable="true" data-visible="false">Category</th>
          <th data-field="lastCached" data-sortable="true" data-formatter="utcTimeSinceFormatter">Last Cache</th>
          <th data-field="createdAt" data-sortable="true" data-formatter="timestampFormatter">Created</th>
          <th data-field="rowsUpdatedAt" data-sortable="true" data-formatter="timestampFormatter">Rows Last Updated</th>
          <th data-field="viewLastModified" data-sortable="true" data-formatter="timestampFormatter">View Last Modified</th>
          <th data-field="description" data-sortable="true" data-formatter="bigCellFormatter">Description</th>
          <th data-field="displayTime" data-sortable="true" data-visible="false">Display Type</th>
          <th data-field="downloadType" data-sortable="true" data-visible="false">Download Type</th>
          <th data-field="newBackend" data-sortable="true" data-visible="false">New Backend</th>
          <th data-field="numberOfComments" data-sortable="true" data-visible="false">Number of Comments</th>
          <th data-field="oid" data-sortable="true" data-visible="false">OID</th>
          <th data-field="rowsUpdatedBy" data-sortable="true" data-visible="false">Rows Updated By</th>
          <th data-field="tableId" data-sortable="true" data-visible="false">Table ID</th>
          <th data-field="totalTimesRated" data-sortable="true" data-visible="false">Total Times Rated</th>
          <th data-field="viewCount" data-sortable="true">View Count</th>
          <th data-field="downloadCount" data-sortable="true">Download Count</th>
          <th data-field="viewType" data-sortable="true" data-visible="false">View Type</th>
          <th data-field="tags" data-sortable="true" data-formatter="tagsFormatter">Tags</th>
        </tr>
      </thead>
    </table>

    <div class="modal" id="aboutModal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">About OpenDataCache</h4>
          </div>
          <div class="modal-body">
            <p>This is a free cache for Socrata open data portals.</p>
            <p>All tabular (CSV, TSV, etc.) datasets available on every Socrata
            open data portal are available here, with several improvements:</p>
            <ul>
              <li><b>Gzip compression.</b>  This can reduce the amount of data
              transferred from several gigabytes to just a few hundred
              megabytes.</li>
              <li><b>Pre-caching</b>, when possible.  This can seriously reduce
              the time between request and response, which can be up to several
              minutes for multi-GB datasets on a Socrata portal.</li>
            </ul>
            <p>The cache is constantly updating.  It should never serve out
            outdated data.  If data on the source portal has been updated since
            the last time the cache grabbed it, the response won't be
            pre-cached but it will still be gzip compressed.</p>
            <p>All code is free and <a href="https://github.com/talos/opendatacache" target="_blank">
              on GitHub</a>.  You are welcome to run your own.  The cache is
            nothing more than <a href="http://nginx.org/" target="_blank">nginx</a> for gzipping and serving the frontend, <a href="http://varnish-cache.org/" target="_blank">Varnish</a> for
              caching, and some shell scripts for warming up.</p>
            <p>There is a ready-to-go <a href="https://registry.hub.docker.com/u/thegovlab/opendatacache/" target="_blank">Docker image</a>.</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

  </body>
</html>
